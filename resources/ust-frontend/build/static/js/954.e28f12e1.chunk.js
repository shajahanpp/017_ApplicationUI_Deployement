"use strict";(self.webpackChunkust_web=self.webpackChunkust_web||[]).push([[954],{85335:function(e,t,r){r.r(t),r.d(t,{Users:function(){return G}});var s=r(4942),n=r(45987),i=r(74165),a=r(15861),o=r(1413),l=r(29439),d=r(53115),c=r(47313),u=r(56352),m=r(73648),p=r(54605),f=r(83069),h=r(2419),x=r(68745),v=r(37784),y=r(66100),w=r(58510),j=r(68598),N=r(62444),b=r(99639),Z=r(50533),g=r(13611),C=r(99255),k=r(57580),q=r(38392),F=r(69973),P=r(70816),D=r.n(P),E=r(84911),U=r(86434),I=r(11777),L=r(46417),S=function(e,t){var r=e?e.id:void 0;return[{name:"firstName",label:"First Name",type:"text",placeholder:"Please Enter First Name",className:"w-100 my-2",required:!0},{name:"lastName",label:"Last Name",type:"text",placeholder:"Please Enter Last Name",className:"w-100 mb-2"},{name:"email",label:"Email",type:"email",placeholder:"Please Enter Email",className:"w-100 mb-2",required:!0},{name:"password",label:"Password",type:"password",placeholder:"Please Enter Password",className:"w-100 mb-2",required:t},{name:"userRole",title:"User Type",type:"list",placeholder:"Please Enter Type",optionValue:"id",optionLabel:"name",options:[{id:1,name:"Admin"},{id:2,name:"User"}],classes:"w-100 mb-2 mt-3",required:!0},{name:"projects",title:"Project Name",classes:"w-100 mb-2 mt-3",type:"list",optionLabel:"projectName",optionValue:"projectId",urlType:"project",isMultiSelect:!0,required:!0},{name:"expiryDate",label:"Expiry Date",type:"datepicker",placeholder:"Please Enter Expiry Date",className:"w-100 mb-2 mt-3",required:!0}].filter((function(e){return"projects"!==e.name||2===r}))},R=function(e){var t,r,s=null===(t=e.userRole)||void 0===t?void 0:t.id;return 2===s&&(r=e.projects.map((function(e){return e.projectId}))),{firstName:e.firstName,lastName:e.lastName,email:e.email,password:e.password,userRoleId:s,projectIds:r,expiryDate:e.expiryDate?1e3*D()(e.expiryDate).unix():void 0}},M=function(){return F.Vo((function(e){var t,r={};return 2===(null===e||void 0===e||null===(t=e.userRole)||void 0===t?void 0:t.id)&&(r=(0,o.Z)((0,o.Z)({},r),{},{projects:F.IX().required("Projects are required").min(1,"Projects are required")})),e.currentFormMode===E.A9&&(r=(0,o.Z)((0,o.Z)({},r),{},{password:F.Z_().required("Password is required")})),F.Ry().shape((0,o.Z)({firstName:F.Z_().required("First Name is required"),email:F.Z_().required("Email is required"),userRole:F.Ry().required("Type is required").nullable(),expiryDate:F.Z_().required("Expiry Date is required").nullable()},r))}))},A=function(e){var t=e.open,r=e.handleFormModalClose,s=e.addUpdateDeleteLoading,n=e.handleSubmit,i=e.currentData;return(0,L.jsx)(I.u,{currentData:i,formModalOpen:t,formTitle:(null===i||void 0===i?void 0:i.currentFormMode)===E.Gt?"Edit Users":"Add User",handleFormModalClose:r,formSaveButtonType:"submit",loading:s||!1,formBody:function(e){var t=e.values;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("input",{name:"email",style:{opacity:0,position:"absolute"}}),(0,L.jsx)("input",{type:"password",style:{opacity:0,position:"absolute"}}),(0,L.jsx)("input",{name:"userRole",style:{opacity:0,position:"absolute"}}),S(null===t||void 0===t?void 0:t.userRole,(null===t||void 0===t?void 0:t.currentFormMode)===E.A9).map((function(e){return(0,U.o)(e)}))]})},passProps:!0,handleSubmit:n,validationSchema:M,submitSetTouched:!0})},T=r(69109),_=["className"];function G(e){var t,r=(0,u.I0)(),F=(0,k.YG)().actions,P=(0,u.v9)(C.yA),D=(0,u.v9)(C.w2),U=(0,u.v9)(C.JN),I=(0,u.v9)(C.ei),S=(0,q.D)(U),M=(0,u.v9)(C.yX),G=(0,q.D)(M)||!1,B=c.useState(!1),V=(0,l.Z)(B,2),z=V[0],H=V[1],X=c.useState(!1),W=(0,l.Z)(X,2),J=W[0],O=W[1],Y=c.useState(),Q=(0,l.Z)(Y,2),$=Q[0],ee=Q[1],te=c.useState({offset:0,limit:10,searchKeyword:""}),re=(0,l.Z)(te,2),se=re[0],ne=re[1],ie=c.useCallback((function(e){ne((function(t){return(0,o.Z)((0,o.Z)({},t),{},{offset:e-1,limit:10})}))}),[]);c.useEffect((function(){!M&&G&&r(F.doGetUsersListsFetch(se))}),[r,F,se,M,G]),c.useEffect((function(){r(F.doGetUsersListsFetch(se))}),[r,F,se]),c.useEffect((function(){return function(){r(F.clearGetUsersListResponse())}}),[r,F]),c.useEffect((function(){S&&!U&&ne((function(e){return(0,o.Z)((0,o.Z)({},e),{},{offset:0,limit:10})})),U||I||(H(I),ee(void 0),O(I))}),[U,ie,I,S]);var ae=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var s,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=t.currentFormMode===E.A9,n=R(t),r(s?F.doPostUserListsFetch((0,o.Z)({},n)):F.doPutUserListsFetch((0,o.Z)({userId:t.userId},n)));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=(0,d.ZP)((function(e){var t=e.className,r=(0,n.Z)(e,_);return(0,L.jsx)(p.Z,(0,o.Z)((0,o.Z)({},r),{},{classes:{popper:t}}))})).withConfig({componentId:"sc-1yt9sqb-0"})((0,s.Z)({},"& .".concat(m.Z.tooltip),{background:" #1C242B",maxWidth:300,padding:"10px",display:"flex",flexWrap:"wrap"})),le=[{field:"firstName",headerName:"Name",width:170,renderCell:function(e){var t=e.row;return(0,L.jsx)("div",{className:"d-flex align-items-center w-100",children:"".concat(t.firstName," ").concat(t.lastName)})}},{field:"email",headerName:"Email",width:250},{field:"userRole",headerName:"User Type",width:190,renderCell:function(e){var t=e.row;return(0,L.jsx)("div",{className:"d-flex align-items-center w-100",children:t.userRole.name})}},{field:"projects",headerName:"Projects",width:400,renderCell:function(e){var t=e.row.projects,r=void 0===t?[]:t;return(0,L.jsxs)("div",{className:"d-flex align-items-center flex-wrap w-100",children:[r.slice(0,2).map((function(e){return(0,L.jsx)("span",{className:"custom-tag-container",children:e.projectName},e.projectId)})),r.length>2&&(0,L.jsx)(oe,{title:r.slice(2).map((function(e,t){return(0,L.jsx)("span",{className:"custom-tag-container bg-white",style:{marginLeft:0===t?0:"unset"},children:e.projectName},t)})),arrow:!0,children:(0,L.jsxs)("span",{className:"custom-tag-container cursor-pointer",children:["+",r.length-2]})})]})}},{field:"action",headerName:"",width:100,sticky:!0,cellClassName:"custom-cell-sticky custom-sticky-right-zero",headerClassName:"",renderCell:function(e){var t=e.row;return(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)("div",{className:"d-flex align-items-center w-100 ",children:[(0,L.jsx)("div",{className:"cursor-pointer me-2",children:(0,L.jsx)(N.r,{onClick:function(){return function(e){H(!0),ee((0,o.Z)((0,o.Z)({},e),{},{currentFormMode:E.Gt}))}(t)}})}),(0,L.jsx)("div",{className:"cursor-pointer",children:(0,L.jsx)(b.r,{onClick:function(){return function(e){O(!0),ee(e)}(t)}})})]})})}}];return(0,L.jsxs)(K,{className:"pb-4",children:[(0,L.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,L.jsx)(f.a,{title:"Users"}),(0,L.jsxs)("div",{className:"d-flex",children:[(0,L.jsx)(y.z,{icon:!1,title:"Sync",onClick:function(){r(k._B.syncKeycloakUsers())},className:"btn-primary-dark btn-primary-dark--sm px-2 mx-2",disabled:M}),(0,L.jsx)(y.z,{icon:!1,title:"Add User",onClick:function(){H(!0),ee({currentFormMode:E.A9})},className:"btn-primary-dark btn-primary-dark--sm",disabled:!1,type:"button"})]})]}),(0,L.jsx)(j.Z,{children:(0,L.jsx)("div",{className:"d-flex align-items-end",children:(0,L.jsx)("div",{children:(0,L.jsx)(w.Z,{label:"",value:(null===se||void 0===se?void 0:se.searchKeyword)||"",setValue:function(e){return ne((0,o.Z)((0,o.Z)({},se),{},{offset:0,searchKeyword:e}))},type:"text",className:"w-100 custom-rate-input",inputProps:{min:1},startAdornment:(0,L.jsx)(Z.r,{style:{height:20,width:20},className:"m-1"}),endAdornment:(null===se||void 0===se||null===(t=se.searchKeyword)||void 0===t?void 0:t.length)>0?(0,L.jsx)(g.r,{className:"m-1",onClick:function(){return ne((0,o.Z)((0,o.Z)({},se),{},{offset:0,searchKeyword:""}))}}):void 0})})})}),(0,L.jsxs)(h.o,{className:"d-flex flex-column h-100 mt-4 mb-5 overflow-hidden",children:[(0,L.jsx)(x.X,{title:""}),(0,L.jsx)(v.Z,{getId:function(e){return e.userId},emptyMsg:"No Users Found",page:se.offset+1,setPageState:ie,checkBoxes:!1,columns:le,recordCount:(null===P||void 0===P?void 0:P.recordCount)||0,rows:(null===P||void 0===P?void 0:P.data)||[],onRowsSelectionHandler:function(e){return e},loading:D,rowHeight:"auto"})]}),(0,L.jsx)(A,{open:z,currentData:$,handleFormModalClose:function(){H(!1)},addUpdateDeleteLoading:U,handleSubmit:ae}),(0,L.jsx)(T.s,{show:J,handleConfirm:function(){r(F.doDeleteuserListsFetch(null===$||void 0===$?void 0:$.userId))},onHide:function(){O(!1),ee(void 0)},submitLoading:U,title:"Confirm Delete",message:"Are you sure you want to delete this User?",btnTitle:"Delete"})]})}var K=d.ZP.div.withConfig({componentId:"sc-1yt9sqb-1"})(["display:flex;flex-direction:column;height:100%;"])}}]);